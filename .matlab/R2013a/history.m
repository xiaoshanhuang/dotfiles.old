%-- Unknown date --%
3:150), glm.t(:,:,11:50,15), [], []);
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=2; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=4; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=5; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=6; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=7; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=8; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=8; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp))9
figure, comp=9; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=10; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=11; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp))3
figure, comp=13; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=14; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=15; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=16; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=17; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=18; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=19; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=20; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=21; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=22; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=23; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=24; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=25; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=26; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=27; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=28; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=29; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=30; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); pause; clf; end;
help parafac
[Factors] = parafac(ersp(1:70,:,:),30,[],[0 1 0],[],[1,0,0],[]);
[Factors] = parafac(ersp(1:70,:,:),30,[],[0 1 0],[],[],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); pause; clf; end;
B_hrf = []; for i = 1:30, B_hrf(i,:) = conv(mapstd(decimate(double(B(:,i)'), 25*2.04)), spm_hrf(2.04));end;
glm = myglm( [B_hrf]', bold.func, bold.mask, [], [10 347], [] );
bold.mask
glm = myglm( [B_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=2; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=4; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=5; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=6; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=7; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=8; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=9; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=10; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=11; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
menory
memory
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
%-- 4/28/13 1:35 PM --%
load('temp.mat')
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
eeglab
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=20; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=19; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=18; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=17; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=16; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); pause; clf; end;
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
help pftest
figure, comp=11; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=13; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
[ssX,Corco,It] = pftest(5,ersp(1:70, 1:5000, :),30,[],[0,1,0],[],[]);
[ssX,Corco,It] = pftest(5,ersp(1:70, 1:5000, :),30,[],[0,1,0],[],[],[]);
[ssX,Corco,It] = pftest(5,ersp(1:70, 1:5000, :),30,[],[0,1,0],[],[];
[ssX,Corco,It] = pftest(5,ersp(1:70, 1:5000, :),30,[],[0,1,0],[],[]);
[ssX,Corco,It] = pftest(5,ersp(1:70, 1:5000, :),30,[],[0,1,0]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:5000, :),30,[],[0,1,0]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:5000, :),30);
help pftest
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),30,[],[0,1,0],[],[],,[]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),30,[],[0,1,0],[],[],[]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),30,[],[0,1,0],[],[]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),5,[],[0,1,0],[],[]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),5,[],[0,1,0]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),5);
help pftest
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),5,[],[0,1,0],[],[]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),5,[],[0,1,0]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),5);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500),5, []);
[ssX,Corco] = pftest(1,ersp(1:70, 1:2500),5);
[ssX,Corco] = pftest(1,ersp(1:70, 1:2500,:),5, [], [0,1,0]);
[ssX,Corco] = pftest(1,ersp(1:70, 1:2500,:),30, [], [0,1,0]);
[ssX,Corco] = pftest(1,ersp(1:70, 1:2500,:),30, [], [0,1,0], [], [], [0 0 0], []);
help pftest
[ssX,Corco] = pftest(1,ersp(1:70, 1:2500,:),30, [], [0,1,0], [], [0 0 0], []);
[Factors] = parafac(ersp(1:70,:,:),6,[],[0 1 0],[],[],[]);
[Factors] = parafac(ersp(1:70,1:2500,:),6,[],[0 1 0],[],[],[]);
[ssX,Corco] = pftest(1,ersp(1:70, 1:2500,:),30, [], [0,1,0], [],[]);
[ssX,Corco] = pftest(1,ersp(1:70, 1:2500,:),30,[], [0,1,0],[],[]);
help pftest
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500,:),30,[], [0,1,0],[],[]);
[ssX,Corco,It] = pftest(1,ersp(1:70, 1:2500,:),30,[], [0,1,0]);
for i = 1:20, c(i) = corcond(ersp(1:70, 1:2500, :),parafac(ersp(1:70, 1:2500, :), i, [], [0,1,0], [],[],[]));
for i = 1:20, c(i) = corcond(ersp(1:70, 1:2500, :),parafac(ersp(1:70, 1:2500, :), i, [], [0,1,0], [],[],[])); end;
for i = 1:20, c(i) = corcond(ersp(1:70, 2000:3000, :),parafac(ersp(1:70, 1:2500, :), i, [], [0,1,0], [],[],[])); end;
for i = 1:20, c(i) = corcond(ersp(1:70, 2000:3000, :),parafac(ersp(1:70, 2000:3000, :), i, [], [0,1,0], [],[],[])); end;
c
[Factors] = parafac(ersp(1:70,2000:3000,:),7,[],[0 1 0],[],[],[]);
c = corcond(ersp(1:70,2000:3000,:),Factors);
c
[A,B,C] = fac2let(Factors);
figure, for comp = 1:7, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[Factors] = parafac(ersp(1:70,2000:4500,:),7,[],[0 1 0],[],[],[]);
c = corcond(ersp(1:70,2000:4500,:),Factors);
c
figure, for comp = 1:7, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[Factors] = parafac(ersp(1:70,:,:),5,[],[0 1 0],[],[],[]);
figure, for comp = 1:5, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[Factors] = parafac(ersp(1:70,:,:),30,[],[0 1 0],[],[0,1,0],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:20, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[Factors] = parafac(ersp(1:70,:,:),30,[],[0 1 0],[],[0,0,1],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
help parafac
[L Gamma alpha R sigma_mcv log] = mscluster(zscore(EEG.data), 12, 25, 40, 200, EEG.chanlocs, 10, 1);
help msclu
help mscluster
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
help parafac
[Factors] = parafac(ersp(1:70,:,:),12,[],[0 1 0],{[], [], Gamma},[0,0,1],[]);
[Factors] = parafac(ersp(1:70,:,:),12,[],[0 1 0],{A, B, Gamma},[0,0,1],[]);
figure, for comp = 1:12, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[A,B,C] = fac2let(Factors);
figure, for comp = 1:12, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
help parafac
ersp(1)
ersp(2)
ersp(100)
help newtimef
ersp = db2mag(ersp)
ersp = db2mag(ersp);
%-- 4/28/13 9:43 PM --%
load('1435_30.mat')
ersp = db2mag(ersp);
[Factors] = parafac(ersp(1:70,:,:),30,[],[3 1 0],[],[],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
eeglab
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
c = corcond(ersp(1:70,:,:),Factors);
%-- 4/28/13 10:17 PM --%
eeglab
%-- 4/28/13 10:20 PM --%
eeglab
clear all
close all
eeglab
load('1435_30.mat')
ersp = db2mag(ersp);
[Factors] = parafac(ersp(1:70,:,:),10,[],[3 1 0],[],[],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[Factors] = parafac(ersp(1:70,:,:),20,[],[3 1 0],[],[],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:20, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/xh030313/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 50);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat
delete bias* binica* temp*
B_hrf = []; for i = 1:20, B_hrf(i,:) = conv(mapstd(decimate(double(B(:,i)'), 25*2.04)), spm_hrf(2.04));end;
glm = myglm( [B_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
memory
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=2; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=4; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=5; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=6; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=7; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=8; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=9; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=10; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=11; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=13; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=14; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=15; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=16; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=17; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=18; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=19; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=20; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
clear glm
figure, for comp = 1:20, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
glm = myglm( [B_hrf(15:20,:)]', bold.func, bold.mask, [], [10 347], [] );
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp+14)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=2; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp+14)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp+14)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=4; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp+14)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=5; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp+14)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=6; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp+14)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
plot(B_hrf')
plot(B_hrf(1:3,:)')
plot(B_hrf(4:6,:)')
[Factors] = parafac(ersp(1:70,:,:),20,[],[2 1 0],[],[],[]);
figure, for comp = 1:20, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[A,B,C] = fac2let(Factors);
figure, for comp = 1:20, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
clear glm
glm = myglm( [B_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=2; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=4; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=5; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=6; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=7; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=8; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=9; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=10; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=11; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=11; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp))2
figure, comp=12; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=13; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=14; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=14; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp))5
figure, comp=15; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=15; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp))6
figure, comp=16; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=17; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=18; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, comp=19; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
figure, plot(B(:,1:3))
figure, plot(B(:,15:20))
figure, plot(B(:,1:3))
figure, plot(B(:,1:20))
figure, for comp = 1:20, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
figure, comp=5; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []);figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp));
%-- 4/29/13 12:12 AM --%
load('1435_30.mat')
eeglab
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
ersp = db2mag(ersp);
[Factors] = parafac(ersp(1:70,:,:),20,[],[0 0 0],[],[0 0 1],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
figure, for comp = 1:20, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[Factors] = parafac(ersp(1:70,:,:),20,[],[2 2 0],[],[1 0 0],[]);
[Factors] = parafac(ersp(1:70,:,:),30,[],[2 2 0],[],[1 0 0],[]);
[Factors] = parafac(ersp(1:70,:,:),20,[],[2 1 0],[],[],[]);
[Factors] = parafac(ersp(1:70,:,:),30,[],[2 1 0],[],[],[]);
%-- 4/29/13 1:08 AM --%
eeglab
for i = 1:EEG.nbchan, chanR(i) = EEG.chanlocs(i).radius; end;
find(chanR<0.5)'
find(chanR>0.5)'
clear all; close all
eeglab
%-- 4/29/13 1:21 AM --%
matlabpool
eeglab
clear ersp times freqs, parfor i = 1:EEG.nbchan, [ersp(:,:,i),itc,powbase,times(:,i),freqs(:,i)] = newtimef(EEG.data(i,:),EEG.pnts , [EEG.xmin EEG.xmax]*1000, EEG.srate, [3 0.5], 'winsize',250, 'timesout', -10, 'plotmean', 'off', 'plotersp', 'off', 'plotitc', 'off'); end;
[Factors] = parafac(ersp(1:70,:,:),10,[],[2 1 0],[],[],[]);
ersp = db2mag(ersp);
[Factors] = parafac(ersp,10,[],[2 1 0],[],[],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:10, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
figure, for comp = 1:10, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(:,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[Factors] = parafac(ersp,3,[],[0 1 0],[],[],[]);
help parafac
[Factors] = parafac(ersp,3,[],[0 1 0],[],[],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:3, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(:,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
for i = 1:10, c(i) = corcond(ersp(:, 2000:3000, :),parafac(ersp(:, 2000:3000, :), i, [], [0,1,0], [],[],[])); end;
%-- 4/29/13 8:57 AM --%
eeglab
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
%-- 4/29/13 9:50 AM --%
eeglab
load('1435_30.mat')
figure, for comp = 1:30, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(1:70,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
[Factors] = parafac(ersp,30,[],[0 1 0],[],[],[]);
%-- 4/29/13 9:55 AM --%
cd matlabroot
matlabroot
delete bias* binica* temp*
eeglab
clear all
close all
eeglab
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 50);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 50);
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha_tc(i,:))), 250*2.04)), spm_hrf(2.04));end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
glm = myglm( [B_hrf]', bold.func, bold.mask, [], [10 347], [] );
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
comp = 3; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 2; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 4; figure, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(:,1), A(:,comp));
close figure
comp = 4; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 5; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 6; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 7; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 8; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 9; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 10; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 10; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs)1
comp = 11; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 12; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 1; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 1; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [-2 2], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [-10 10], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [-8 8], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [-5 5], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [-4 4], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,13), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
R
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 11, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 10, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 9, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 10, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:10, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
sigma_mcv
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 50);
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, topoplot(Gamma(:,3), EEG.chanlocs)
figure, topoplot(Gamma(:,2), EEG.chanlocs)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, topoplot(Gamma(:,3), EEG.chanlocs)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [-2 2], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
comp = 5; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [-2 2], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 5; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 6; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 7; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 8; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 9; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 10; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 11; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 1; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
comp = 2; figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp+1), [], []); figure, topoplot(Gamma(:,comp), EEG.chanlocs);
figure, for i = 1:10, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
fftplot(alpha(4,:), EEG.srate, [0.1 50])
figure, fftplot(alpha(4,:), EEG.srate, [0.1 50])
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 13, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, for i = 1:13, subplot(3,5,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
%-- 4/29/13 11:53 AM --%
eeglab
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,13), [], []);
sigma_mcv
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, fftplot(alpha(10,:), EEG.srate, [0.1 50])
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,13), [], []);
c = corr(alpha_hrf);
c
c = corr(alpha_hrf');
figure, imagesc(c)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARC/ql041913_2/CovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/ql041913_2_BrainMask_05_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
anat = load_nii('20130419_095448LuoQingfei.nii');
figure, disp_act_slic([5,6], anat, glm.t(:,:,:,2), [], []);
figure, disp_act_slic([5,6], anat.img, glm.t(:,:,:,2), [], []);
anat
figure, disp_act_slic([5,6], double(anat.img), glm.t(:,:,:,2), [], []);
glm
figure, disp_act_slic([5,6], anat.img, glm.t(:,:,:,2), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,2), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,3), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,4), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,5), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,10), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,11\), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,11), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,12), [], []);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,13), [], []);
%-- 4/29/13 3:14 PM --%
eeglab
delete bias* binica* temp*
%-- 4/30/13 3:08 PM --%
eeglab
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
clear ersp times freqs, parfor i = 1:EEG.nbchan, [ersp(:,:,i),itc,powbase,times(:,i),freqs(:,i)] = newtimef(EEG.data(i,:),EEG.pnts , [EEG.xmin EEG.xmax]*1000, EEG.srate, [3 0.5], 'winsize',250, 'timesout', -10, 'plotmean', 'off', 'plotersp', 'off', 'plotitc', 'off'); end;
matlabpool
%-- 4/30/13 3:41 PM --%
delete bias* binica* temp*
matlabpool
%-- 4/30/13 3:42 PM --%
matlabroot
%-- 4/30/13 3:50 PM --%
matlabpool
eeglab
clear ersp times freqs, parfor i = 1:EEG.nbchan, [ersp(:,:,i),itc,powbase,times(:,i),freqs(:,i)] = newtimef(EEG.data(i,:),EEG.pnts , [EEG.xmin EEG.xmax]*1000, EEG.srate, [3 0.5], 'winsize',250, 'timesout', -10, 'plotmean', 'off', 'plotersp', 'off', 'plotitc', 'off'); end;
[Factors] = parafac(ersp,3,[],[0 1 0],[],[],[]);
[A,B,C] = fac2let(Factors);
figure, for comp = 1:5, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(:,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
figure, for comp = 1:3, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(:,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
c = corcond(ersp,Factors);
c
[Factors] = parafac(ersp,5)
c = corcond(ersp,Factors);
c
[A,B,C] = fac2let(Factors);
figure, for comp = 1:3, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(:,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
figure, for comp = 1:5, subplot(2,1,1), topoplot(zscore(C(:,comp)), EEG.chanlocs); subplot(2,1,2), plot(freqs(:,1), A(:,comp)); title(num2str(comp)); pause; clf; end;
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(mapstd(bcgTemp),4.45);
figure, plot(diff(peakLoc(1:end-1)))
for i = 1:length(peakLoc), EEG.event(end+1) = struct('type', 'bcg', 'latency', peakLoc(i)-40, 'urevent', [], 'duration', []); end;
help eeg_pca
help princomp
coeff = pca(EEG.data(80,:,:))
coeff = pca(EEG.data(80,:,:));
coeff = pca(squeeze(EEG.data(80,:,:)));
[coeff, score] = pca(squeeze(EEG.data(80,:,:)));
plot(score(:,1))
plot(score(:,2))
plot(score(:,3))
plot(score(:,4))
plot(score(:,5))
plot(score(:,6))
plot(score(:,1))
plot(score(:,2))
plot(score(:,3))
help SIM
[A,S,z] = SIM(EEG.data,50);
plot(z(1,:))
plot(A(1,:))
figure, topoplot(A(1,:))
figure, topoplot(A(1,:),EEG.chanlocs)
figure, topoplot(A(:,1),EEG.chanlocs)
[A,S,z] = SIM(EEG.data);
figure, topoplot(A(:,1),EEG.chanlocs)
clear A S z
[A,S,z] = SIM(EEG.data);
figure, topoplot(abs(A(:,1)),EEG.chanlocs)
[A,S,z] = SIM(double(EEG.data));
figure, topoplot(A(:,1),EEG.chanlocs)
figure, topoplot(A(:,2),EEG.chanlocs)
figure, topoplot(A(:,3),EEG.chanlocs)
figure, topoplot(A(:,4),EEG.chanlocs)
figure, topoplot(A(:,5),EEG.chanlocs)
figure, topoplot(A(:,6),EEG.chanlocs)
figure, topoplot(A(:,7),EEG.chanlocs)
figure, topoplot(A(:,8),EEG.chanlocs)
figure, topoplot(A(:,9),EEG.chanlocs)
figure, topoplot(A(:,10),EEG.chanlocs)
plot(z(80,:))
plot(z(1,:))
plot(z(2,:))
figure, for comp = 1:5, subplot(2,1,1), topoplot(A(:,comp), EEG.chanlocs); subplot(2,1,2), plot(EEG.times, z(comp,:)); title(num2str(comp)); pause; clf; end;
figure, for comp = 1:5, subplot(2,1,1), topoplot(A(:,comp), EEG.chanlocs); subplot(2,1,2), plot(EEG.times, z(comp,:)); title(num2str(comp)); grid on; pause; clf; end;
figure, for comp = 1:10, subplot(2,1,1), topoplot(A(:,comp), EEG.chanlocs); subplot(2,1,2), plot(EEG.times, z(comp,:)); title(num2str(comp)); grid on; pause; clf; end;
figure, for comp = 1:30, subplot(2,1,1), topoplot(A(:,comp), EEG.chanlocs); subplot(2,1,2), plot(EEG.times, z(comp,:)); title(num2str(comp)); grid on; pause; clf; end;
figure, for comp = 1:50, subplot(2,1,1), topoplot(A(:,comp), EEG.chanlocs); subplot(2,1,2), plot(EEG.times, z(comp,:)); title(num2str(comp)); grid on; pause; clf; end;
eeglab
bcg = []; for i = 1:10, bcg(:,:,i) = A(:,i)*z(i,:); end;
plot(bcg(135,:,1))
plot(bcg(135,:,2))
plot(bcg(135,:,3))
plot(bcg(135,:,4))
plot(bcg(135,:,5))
plot(bcg(135,:,7))
figuer, plot(bcg(135,:,7)), figure, topoplot(A(:,7),EEG.chanlocs)
figure, plot(bcg(135,:,7)), figure, topoplot(A(:,7),EEG.chanlocs)
delete temp.mat
fmrib_pas
figure, for comp = 1:137, subplot(2,1,1), topoplot(A(:,comp), EEG.chanlocs); subplot(2,1,2), plot(EEG.times, z(comp,:)); title(num2str(comp)); grid on; pause; clf; end;
figure, for comp = 1:137, subplot(2,1,1), topoplot(A(:,comp), EEG.chanlocs); subplot(2,1,2), plot(z(comp,:)); title(num2str(comp)); grid on; pause; clf; end;
%-- 4/30/13 11:00 PM --%
eeglab
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(mapstd(bcgTemp),4.45);
figure, plot(diff(peakLoc(1:end-1)))
for i = 1:length(peakLoc), EEG.event(end+1) = struct('type', 'bcg', 'latency', peakLoc(i)-40, 'urevent', [], 'duration', []); end;
[A,S,z] = SIM(double(EEG.data));
help epoch
figure, for comp = 1:35, subplot(2,1,1), topoplot(A(:,comp), EEG.chanlocs); subplot(2,1,2), plot(z(comp,:)); title(num2str(comp)); grid on; pause; clf; end;
help squeeze
help pop_selectevent
[eventout fields] = eeg_eventformat( EEG.event, 'array', {'latency'} );
[eventout fields] = eeg_eventformat( EEG.event, 'struct', {'latency'} );
fields
eventout
EEG.event
help struct
%-- 5/1/13 12:08 PM --%
eeglab
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARC/ql041913_2/CovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/ql041913_2_BrainMask_05_91x109x91.nii', 20);
help myglm
glm = myglm( [alpha_hrf]', bold.func, bold.mask, 0.01, [10 347], [] );
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,6], anat.img, glm.t(:,:,:,2), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
anats
size(anats)
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
glm.t
glm
size(glm.t)
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, 0.01, [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
%-- 5/1/13 1:18 PM --%
eeglab
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(mapstd(bcgTemp),4.45);
figure, plot(diff(peakLoc(1:end-1)))
for i = 1:length(peakLoc), EEG.event(end+1) = struct('type', 'bcg', 'latency', peakLoc(i)-40, 'urevent', [], 'duration', []); end;
EEG = pas_sim(EEG, peakLoc-40, 'sim', 30);
size(10-100:10+100);
ans
size(-100:100)
EEG = pas_sim(EEG, peakLoc-40, 'sim', 30);
[ALLEEG EEG] = eeg_store(ALLEEG, EEG, CURRENTSET);
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
EEG = pas_sim(EEG, peakLoc-40, 'sim', 30);
[ALLEEG EEG] = eeg_store(ALLEEG, EEG, CURRENTSET);
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
delete temp.mat
delete bias* binica* temp*
nii = loadnii('swCovRegressed_4DVolume.nii');
help load_nii
nii = load_nii('swCovRegressed_4DVolume.nii');
nii.
nii
nii.hdr
nii.hdr.dime
%-- 5/1/13 2:33 PM --%
%-- 5/1/13 2:34 PM --%
cd ~/Desktop/
ls
load('ms_ql041913_2.mat')
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARC/ql041913_2/CovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/ql041913_2_BrainMask_05_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,2), [], []);
anat = load_nii('20130419_095448LuoQingfei.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,2), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,3), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,3), [-3 3], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImg/ql041913_2/*.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/ql041913_2_BrainMask_05_91x109x91.nii', 20);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImg/ql041913_2/99328.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/ql041913_2_BrainMask_05_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,2), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,3), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,5), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [-0.1 0.1], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,5), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,6), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [-0.1 0.1], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [-2.5 2.5], [-7.5 7.5]);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,3), [-2.5 2.5], [-7.5 7.5]);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,1), [-2.5 2.5], [-7.5 7.5]);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,2), [-2.5 2.5], [-7.5 7.5]);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,3), [-2.5 2.5], [-7.5 7.5]);
eeglab
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,2), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [], []);
clear all
close all
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImg/ql041913_1/02048.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/ql041913_1_BrainMask_05_91x109x91.nii', 20);
anat = load_nii('20130419_095448LuoQingfei.nii');
anats = imresize(anat.img, 1/2);
load('ms_ql041913_2.mat')
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImg/ql041913_1/02048.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/ql041913_1_BrainMask_05_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
anat = load_nii('20130419_095448LuoQingfei.nii');
anats = imresize(anat.img, 1/2);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anatts = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,2), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,3), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,4), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,1), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,2), [], [-7.5 7.5]);
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,2), [], []);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, 0.01, [10 347], [] );
figure, disp_act_slc([5,6], anats, glm.t(:,:,:,2), [], []);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,4), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,5), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,6), [], [-7.5 7.5]);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCW/ql041913_1/wCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
%-- 5/1/13 3:46 PM --%
help isnan
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCW/ql041913_1/wCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
load('ms_ql041913_2.mat')
glm = myglm( [alpha_hrf]', bold.func, bold.mask, 0.01, [10 347], [] );
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
bold.func
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,2), [], [-7.5 7.5]);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anatts(:,:,33:3:150), glms.t(:,:,11:50,2), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glms.t(:,:,11:50,2), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], [-7.5 7.5]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [-5 5], [-7.5 7.5]);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [-5 5], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [-4 4], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [-5 5], []);
eeglab
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,13), [], []);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
for i = 1:size(glm.t,4), for j = 1:size(glm.t,3), glm.t(:,:,j,i) = fcnFirstOrderStatisticsFilter(glm.t(:,:,j,t), bold.mask(:,:,j,t)); end; end;
for i = 1:size(glm.t,4), for j = 1:size(glm.t,3), glm.t(:,:,j,i) = fcnFirstOrderStatisticsFilter(glm.t(:,:,j,i), bold.mask(:,:,j,i)); end; end;
for i = 1:size(glm.t,4), for j = 1:size(glm.t,3), glm.t(:,:,j,i) = fcnFirstOrderStatisticsFilter(glm.t(:,:,j,i)); end; end;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, 0.01, [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
%-- 5/1/13 11:47 PM --%
%-- 5/4/13 11:24 AM --%
%-- 5/4/13 11:27 AM --%
help coder
coder
%-- 5/4/13 2:41 PM --%
eeglab
%-- 5/5/13 12:47 PM --%
delete bias* binica* temp*
load('sensorData.mat')
help runica
[weights,sphere] = runica(sensorData);
[weights,sphere] = runica(sensorData');
[weights,sphere] = runica(zscore(sensorData)');
motionInput
[weights,sphere] = runica(zscore(sensorData(:,2:9))');
figure, plot(sensorData(:,2:9))
figure, plot(sensorData(:,2:4))
[weights,sphere] = runica(zscore(sensorData(:,2:4))');
figure, plot(zscore(sensorData(:,2:4)))
lastFilename
figure, plot(zscore(sensorData(:,5:8)))
figure, plot(zscore(sensorData(:,3:5)))
figure, plot(zscore(sensorData(:,6:9)))
figure, plot(zscore(sensorData(:,10:12)))
figure, plot(zscore(dataChunk(:,3:5)))
figure, plot(zscore(sensorData(:,10:12)))
dataChunk =  sensorData(38000:38500,:);
figure, plot(zscore(dataChunk(:,3:5)))
figure, plot(zscore(dataChunk(:,6:9)))
help princomp
dataChunk =  sensorData(38001:38500,:);
[coeff, score] = pca(dataChunk(:,3:9));
figure, plot(score(:,1))
figure, plot(score(:,2))
figure, plot(score(:,3))
figure, plot(score(:,4))
figure, plot(score(:,5))
figure, plot(score(:,6))
figure, fftplot(score(:,1), SAMPLE_RATE, [0.1 10])
figure, fftplot(score(:,2), SAMPLE_RATE, [0.1 10])
for i = 1:5, subplot(5,1,i), fftplot(score(:,i), SAMPLE_RATE, [0.1 5]); end;
[coeff, score] = pca(dataChunk(:,3:5));
for i = 1:3, subplot(3,1,i), fftplot(score(:,i), SAMPLE_RATE, [0.1 5]); end;
motionInput
for i = 1:3, subplot(3,1,i), fftplot(score(:,i), SAMPLE_RATE, [0.1 5]); end;
for i = 1:500, ap(i) = sensorData(i,3:5)*sensorData(i,6:8)'; end;
figure, plot(ap)
figure, plot(dataChunk(:,6:8))
figure, plot(dataChunk(:,3:5))
motionInput
%-- 5/5/13 4:12 PM --%
eeglab
%-- 5/5/13 4:16 PM --%
eeglab
%-- 5/5/13 6:49 PM --%
eeglab
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
help find
L(1:10)
figure, for i = 1:20, subplot(1, 20, i), topoplot(EEG.data(i), EEG.chanlocs); title(num2str(L(i))); end;
figure, for i = 1:10, subplot(1, 10, i), topoplot(EEG.data(i), EEG.chanlocs); title(num2str(L(i))); end;
figure, for i = 1:10, subplot(1, 20, i), topoplot(EEG.data(:,i), EEG.chanlocs); title(num2str(L(i))); end;
figure, for i = 1:20, subplot(1, 20, i), topoplot(EEG.data(:,i), EEG.chanlocs); title(num2str(L(i))); end;
figure, for i = 1:200, subplot(10, 20, i), topoplot(EEG.data(:,i), EEG.chanlocs); title(num2str(L(i))); end;
figure, for i = 1000:1100, subplot(10, 10, i), topoplot(EEG.data(:,i), EEG.chanlocs); title(num2str(L(i))); end;
figure, for i = 1001:1100, subplot(10, 10, i-1000), topoplot(EEG.data(:,i), EEG.chanlocs); title(num2str(L(i))); end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
R
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 11, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 10, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 9, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 10, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
figure, for i = 1:10, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, fftplot(alpha(8,:), EEG.srate, [5 14])
figure, fftplot(alpha(9,:), EEG.srate, [5 14])
figure, fftplot(alpha(10,:), EEG.srate, [5 14])
figure, fftplot(alpha(7,:), EEG.srate, [5 14])
figure, fftplot(alpha(4,:), EEG.srate, [5 14])
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, fftplot(EEG.data(10,:), EEG.srate, [0.1 50])
figure, fftplot(EEG.data(10,:), EEG.srate, [0.5 50])
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 10, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:10, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 10, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:10, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 9, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 11, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:10, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
sigma_mcv
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 12, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 11, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
figure, for i = 1:12, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 11, 200, EEG.chanlocs, 10, 1, 25, 40);
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
sigma_mcv
L1 = L;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 11, 200, EEG.chanlocs, 10, 1, 25, 40);
sigma_mcv
L2 = L;
sum(L1~=L2)
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
L(1:100)
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 11, 200, EEG.chanlocs, 10, 1, 25, 1);
R
sigma_mcv
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
L
L(1:100)
L(100:200
L(100:200)
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
find(L==1)
sum(find(L==1))
sum(find(L==2))
sum(find(L==3))
sum(find(L==4))
sum(find(L==5))
sum(find(L==6))
sum(find(L==7))
sum(find(L==8))
sum(find(L==9))
sum(find(L==10))
sum(L==1)
sum(L==2)
sum(L==3)
sum(L==5)
sum(L==4)
sum(L==6)
sum(L==7)
sum(L==8)
sum(L==9)
sum(L==10)
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = conv(mapstd(decimate(double(abs(alpha(i,:))), 250*2.04)), spm_hrf(2.04));end;
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, plot(alpha(2:3, :))
%-- 5/6/13 9:14 AM --%
eeglab
clear all; close all
eeglab
[gfp,gd] = eeg_gfp(EEG.data',1);
plot(gfp)
peakLoc = peakfinder(mapstd(gfp),1);
peakLoc = peakfinder(zscore(gfp),1);
figure, plot(EEG.times, gfp), hold on; plot(EEG.times(peakLoc), gfp(peakLoc), 'ro')
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data(:,peakLoc), 11, 200, EEG.chanlocs, 10, 1, 25, 1);
sigma_mcv
R
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data(:,peakLoc), 11, 200, EEG.chanlocs, 10, 1, 25, 1);
sigma_mcv
R
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data(:,peakLoc), 10, 200, EEG.chanlocs, 10, 1, 25, 1);
sigma_mcv
figure, for i = 1:11, subplot(3,4,i), topoplot(Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data(:,peakLoc), 11, 200, EEG.chanlocs, 10, 1, 25, 1);
find(L==1)
sum(L==1)
sum(L==2)
sum(L==3)
sum(L==4)
sum(L==5)
sum(L==6)
sum(L==7)
gfp_hrf = conv(mapstd(decimate(double(gfp'), 250*2.04)), spm_hrf(2.04));
gfp_hrf1 = mapstd(decimate(conv(gfp', spm_hrf(250*2.04)), 250*2.04));
gfp_hrf1 = mapstd(decimate(conv(double(gfp)', spm_hrf(250*2.04)), 250*2.04));
figure, plot([gfp_hrf gfp_hrf1])
figure, plot([gfp_hrf;gfp_hrf1])
figure, plot([gfp_hrf(1,1:348);gfp_hrf1])
figure, plot([gfp_hrf(1,1:348);gfp_hrf1]')
figure, plot([gfp_hrf(1,1:348)-gfp_hrf1]')
sum([gfp_hrf(1,1:348)-gfp_hrf1])
[gfp_hrf(1,1:348)-gfp_hrf1]
gfp_hrf1 = mapstd(decimate(conv(double(gfp)', spm_hrf(250*2.04)), 250*2.04));
plot(conv(double(gfp)', spm_hrf(250*2.04)))
help conv
plot(spm_hrf(250*2.04))
help spm_hrf
plot(spm_hrf(2.04))
plot(spm_hrf(100))
plot(spm_hrf(2.04/250))
plot(spm_hrf(2.04))
plot(spm_hrf(2.04/250))
plot(spm_hrf(2.04))
plot(spm_hrf(2.04/250))
plot(spm_hrf(2.04/510))
gfp_hrf1 = mapstd(decimate(conv(double(gfp)', spm_hrf(2.04/510)), 250*2.04));
figure, plot([gfp_hrf(1,1:348);gfp_hrf1]')
figure, plot([gfp_hrf;gfp_hrf1]')
gfp_hrf = conv((decimate(double(gfp'), 250*2.04)), spm_hrf(2.04));
gfp_hrf1 = (decimate(conv(double(gfp)', spm_hrf(2.04/510)), 250*2.04));
figure, plot([gfp_hrf;gfp_hrf1]')
help decimate
gfp_hrf = conv((decimate(double(gfp'), 250*2.04, 'FIR')), spm_hrf(2.04));
figure, plot([gfp_hrf;gfp_hrf1]')
gfp_hrf1 = (decimate(conv(double(gfp)', spm_hrf(2.04/510)), 250*2.04, 'FIR'));
figure, plot([gfp_hrf;gfp_hrf1]')
figure, plot(conv(double(gfp)', spm_hrf(2.04/510)))
plot(gfp_hrf1)
figure, plot(conv(double(gfp)', spm_hrf(2.04/510)))
figure, plot(gfp_hrf1)
figure, plot(gfp_hrf)
figure, plot(gfp_hrf1)
figure, plot(conv(double(gfp)', spm_hrf(2.04/510)))
date
msEEG = microstateEEG(EEG, 11);
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
delete bias* binica* temp*
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, for i = 1:11, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG.R
msEEG.sigma_mcv
figure, for i = 1:11, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
print(gcf, '-dtiff','fig.tiff' )
edit myglm
glm.t = circshift(glm.t,1);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
glm.t = circshift(glm.t,-2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
glm.t = circshift(glm.t,1);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
help circshift
glm.t = circshift(glm.t,2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
glm.t = circshift(glm.t,4);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
glm.t = circshift(glm.t,[4 1]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
glm.t = circshift(glm.t,[4 1]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
size(glm.t)
help glmfit
msEEG
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
msEEG = microstateEEG(EEG, 11);
figure, for i = 1:11, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
R = corr(msEEG.alpha_hrf');
imagesc(R, [-1 1])
figure, for i = 1:11, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG.sigma_mcv
msEEG = microstateEEG(EEG, 10);
msEEG
figure, for i = 1:10, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG = microstateEEG(EEG, 9);
figure, for i = 1:9, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG = microstateEEG(EEG, 8);
msEEG
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG = microstateEEG(EEG, 11);
msEEG
msEEG = microstateEEG(EEG, 12);
msEEG
msEEG = microstateEEG(EEG, 11);
msEEG
figure, for i = 1:11, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
imagesc(corr(msEEG.alpha_hrf), [-1 1])
imagesc(corr(msEEG.alpha_hrf'), [-1 1])
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=2; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=4; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=5; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=6; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=7; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=8; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=9; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
glm = myglm( [msEEG.gfp_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
%-- 5/6/13 12:02 PM --%
eeglab
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, comp=1; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=2; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=2; disp_act_slc([5,8], anats(:,:,33:3:150), glm.3(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.3(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=3; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=4; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=5; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=6; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=7; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
figure, comp=8; disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,comp), [], []);figure, topoplot(msEEG.Gamma(:,comp), EEG.chanlocs);
%-- 5/6/13 12:13 PM --%
eeglab
help eeglab
eeglab redraw
msEEG_alpha = microstateEEG(EEG, 8);
msEEG_theta = microstateEEG(EEG, 8);
msEEG_beta = microstateEEG(EEG, 8);
msEEG_gamma = microstateEEG(EEG, 8);
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG_alpha.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG_alpha.theta(:,i), EEG.chanlocs); title(num2str(i));end;
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG_theta.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG_beta.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
figure, for i = 1:8, subplot(3,4,i), topoplot(msEEG_gamma.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG_alpha = microstateEEG(EEG, 4);
figure, for i = 1:4, subplot(3,4,i), topoplot(msEEG_alpha.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG_alpha = microstateEEG(EEG, 4);
figure, for i = 1:4, subplot(3,4,i), topoplot(msEEG_alpha.Gamma(:,i), EEG.chanlocs); title(num2str(i));end;
msEEG_alpha = microstateEEG(EEG, 8);
G = [msEEG_theta.Gamma msEEG_alpha.Gamma msEEG_beta.Gamma msEEG_gamma.Gamma];
figure, for i = 1:32, subplot(4,8,i), topoplot(G(:,i), EEG.chanlocs);
figure, for i = 1:32, subplot(4,8,i), topoplot(G(:,i), EEG.chanlocs); end;
help spsmoothness
help sort
P = spsmoothness(msEEG_theta.Gamma, EEG.chanlocs, 5);
size(P)
[Y,I] = sort(P)
help sort
figure, for i = 1:32, subplot(4,8,i), topoplot(G(:,i), EEG.chanlocs); end;
G = [];
spmap = msEEG_theta.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap.Gamma(:,I)];
spmap = msEEG_theta.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap(:,I)];
spmap = msEEG_alpha.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap(:,I)];
spmap = msEEG_beta.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap(:,I)];
spmap = msEEG_gamma.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap(:,I)];
figure, for i = 1:32, subplot(4,8,i), topoplot(G(:,i), EEG.chanlocs); end;
print(gcf, '-dtiff','fig.tiff' )
figure, for i = 1:32, subplottight(4,8,i), topoplot(G(:,i), EEG.chanlocs); end;
print(gcf, '-dtiff','fig.tiff' )
msEEG_theta = microstateEEG(EEG, 8);
msEEG_alpha = microstateEEG(EEG, 8);
msEEG_beta = microstateEEG(EEG, 8);
msEEG_alpha = microstateEEG(EEG, 8);
msEEG_beta = microstateEEG(EEG, 8);
msEEG_gamma = microstateEEG(EEG, 8);
G = [];
spmap = msEEG_theta.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap(:,I)];
spmap = msEEG_alpha.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap(:,I)];
spmap = msEEG_beta.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap(:,I)];
spmap = msEEG_gamma.Gamma; P = spsmoothness(spmap, EEG.chanlocs, 5); [Y,I] = sort(P); G = [G spmap(:,I)];
figure, for i = 1:32, subplottight(4,8,i), topoplot(G(:,i), EEG.chanlocs); end;
print(gcf, '-dtiff','fig.tiff' )
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
print(gcf, '-dtiff','fig.tiff' )
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
print(gcf, '-dtiff','fig.tiff' )
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
msEEG = microstateEEG(EEG, 8);
%-- 5/7/13 9:13 AM --%
eeglab
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,13), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,14), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,15), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,16), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,17), [], []);
msEEG_theta = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG_theta.Gamma(:,i), EEG.chanlocs); end;
msEEG_theta = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG_theta.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( [msEEG_theta.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG_theta.Gamma(:,i), EEG.chanlocs); end;
msEEG_alpha = microstateEEG(EEG, 8);
msEEG_alpha = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG_theta.Gamma(:,i), EEG.chanlocs); end;
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG_alpha.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( [msEEG_alpha.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
%-- 5/8/13 10:59 AM --%
eeglab
ic_alpha = eeg_getica(EEG,4);
ic_alpha_hrf = decimate(conv(abs(ic_alpha(i,:)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
ic_alpha_hrf = decimate(conv(abs(ic_alpha), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
ic_alpha_hrf = decimate(conv(abs(double(ic_alpha)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
glm = myglm( [ic_alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, fftpplot(ic_alpha, EEG.srate, [0.1 30])
figure, fftpplot(double(ic_alpha), EEG.srate, [0.1 30])
figure, fftplot(double(ic_alpha), EEG.srate, [0.1 30])
ic_alpha_hrf1 = decimate(conv(abs(double(ic_alpha)), spm_hrf(1/EEG.srate)), EEG.srate*2.04);
figure, plot([ic_alpha_hrf; ic_alpha_hrf1]')
ic_alpha_hrf = decimate(conv(abs(double(ic_alpha)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
figure, plot([ic_alpha_hrf; ic_alpha_hrf1]')
glm = myglm( [ic_alpha_hrf1]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
ic_alpha = eeg_getica(EEG,8);
ic_alpha_hrf = decimate(conv(abs(double(ic_alpha)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
imagesc(corr(ica_alpha_hrf(10:347), bold.winv(10:347,:)), [-1 1])
imagesc(corr(ic_alpha_hrf(1,10:347), bold.winv(10:347,:)), [-1 1])
imagesc(corr(ic_alpha_hrf(1,10:347)', bold.winv(10:347,:)), [-1 1])
imagesc(corr(ic_alpha_hrf(1,10:347)', bold.winv(10:347,:)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
ic_alpha = eeg_getica(EEG,11);
ic_alpha_hrf = decimate(conv(abs(double(ic_alpha)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
imagesc(corr(ic_alpha_hrf(1,10:347)', bold.winv(10:347,:)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
ic_alpha = eeg_getica(EEG,24);
ic_alpha_hrf = decimate(conv(abs(double(ic_alpha)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
imagesc(corr(ic_alpha_hrf(1,10:347)', bold.winv(10:347,:)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,12), [], []);
imagesc(corr(ic_alpha_hrf(1,10:347)', bold.winv(10:347,:)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,12), [], []);
%-- 5/10/13 11:04 AM --%
%-- 5/12/13 6:27 PM --%
delete bias* binica* temp*
eeglab
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG_alpha.Gamma(:,i), EEG.chanlocs); end;
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
figure, imagesc(corr(msEEG.alpha_hrf(:,10:347)', bold.winv(10:347, :)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, imagesc(corr(msEEG.alpha_hrf(:,10:347)', bold.winv(10:347, :)))
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
plot(bold.winv(:,6))
figure, plot(bold.winv(:,6))
figure, plot(bold.winv(10:347,6))
dmn = deconv(bold.winv(10:347,6), spm_hrf(2.04));
help deconv
dmn = deconv(spm_hrf(2.04), bold.winv(10:347,6));
plot(spm_hrf(2.04))
help resample
dmn = resample(bold.winv(:,6), 250, 1/2.04);
dmn = resample(bold.winv(:,6), 250*2.04, 1);
bold
help deconv
eeg_alpha = eeg_getica(EEG,4);
plot(eeg_alpha)
plot(dmn)
help hilbert
eeg_alpha_hibert = hilbert(eeg_alpha);
plot([eeg_alpha; eeg_alpha_hibert])
plot([eeg_alpha; eeg_alpha_hibert]');
plot([eeg_alpha; abs(eeg_alpha_hibert)]');
plot([eeg_alpha; real(eeg_alpha_hibert)]');
plot([real(eeg_alpha_hibert)]');
eeg_alpha_hibert = hilbert(eeg_alpha');
plot([eeg_alpha; real(eeg_alpha_hibert)]');
plot([eeg_alpha' real(eeg_alpha_hibert)]);
plot([eeg_alpha' (eeg_alpha_hibert)]);
plot([eeg_alpha' abs(eeg_alpha_hibert)]);
%-- 5/12/13 9:44 PM --%
eeglab
eeg_alpha = eeg_getica(EEG,4);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
dmn = resample(bold.winv(:,6), 250*2.04, 1);
eeg_alpha_hibert = hilbert(eeg_alpha');
eeg_alpha_hibert = img(hilbert(eeg_alpha'));
eeg_alpha_hibert = imag(hilbert(eeg_alpha'));
plot([eeg_alpha' eeg_alpha_hibert])
help imag
plot([EEG.data(1,:); imag(hilbert(EEG.data(1,:)'))'])
plot([EEG.data(1,:); imag(hilbert(EEG.data(1,:)'))']')
plot([EEG.data(1,:); real(hilbert(EEG.data(1,:)'))']')
plot([EEG.data(1,:); abs(hilbert(EEG.data(1,:)'))']')
dmn = resample(bold.winv(1:347,6), 250*2.04, 1);
eeg_alpha = eeg_getica(EEG,4);
eeg_alpha_hilbert = abs(hilbert(eeg_alpha));
dmn = dmn';
help deconv
[Q,R] = deconv(eeg_alpha_hilbert', dmn');
[Q,R] = deconv(eeg_alpha_hilbert, dmn);
[Q,R] = deconv(eeg_alpha_hilbert(2500:170000), dmn(2500:170000));
[Q,R] = deconv(eeg_alpha_hilbert(2500:170000)', dmn(2500:170000)');
delete bias* binica* temp*
%-- 5/12/13 10:41 PM --%
eeglab
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
dmn = resample(bold.winv(1:347,6), 250*2.04, 1);
alpha_eeg_hilbert = abs(hilbert(EEG.data'));
help hilbert
alpha_eeg_hilbert = abs(hilbert(EEG.data'))';
alpha_eeg_hilbert_hrf = conv(alpha_eeg_hilbert, spm_hrf(1/250));
alpha_eeg_hilbert_hrf = []; for i = 1:EEG.nbchan, alpha_eeg_hilbert_hrf(i,:) = conv(alpha_eeg_hilbert(i,:), spm_hrf(1/EEG.srate)); end;
help cca
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,2500:170000),dmn(2500:170000)');
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,2500:170000)',dmn(2500:170000)');
%-- 5/12/13 10:55 PM --%
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
eeglab
alpha_eeg_hilbert_hrf = []; for i = 1:EEG.nbchan, alpha_eeg_hilbert_hrf(i,:) = conv(alpha_eeg_hilbert(i,:), spm_hrf(1/EEG.srate)); end;
alpha_eeg_hilbert_hrf = conv(alpha_eeg_hilbert, spm_hrf(1/250));
alpha_eeg_hilbert = abs(hilbert(EEG.data'))';
alpha_eeg_hilbert_hrf = []; for i = 1:EEG.nbchan, alpha_eeg_hilbert_hrf(i,:) = conv(alpha_eeg_hilbert(i,:), spm_hrf(1/EEG.srate)); end;
alpha_eeg_hilbert_hrf = []; for i = 1:EEG.nbchan, alpha_eeg_hilbert_hrf(i,:) = decimate(conv(alpha_eeg_hilbert(i,:), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
alpha_eeg_hilbert_hrf = []; for i = 1:EEG.nbchan, alpha_eeg_hilbert_hrf(i,:) = decimate(double(conv(alpha_eeg_hilbert(i,:), spm_hrf(1/EEG.srate))), EEG.srate*2.04, 'FIR'); end;
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 6));
figure, topoplot(A)
figure, topoplot(A, EEG.chanlocs)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, :));
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(:,i), EEG.chanlocs); title(num2str(i)); end;
R
r
figure, for i = 1:20, subplot(4, 5, i), topoplot(invA(:,i), EEG.chanlocs); title(num2str(i)); end;
A = pinv(A);
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(i,:), EEG.chanlocs); title(num2str(i)); end;
B
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 5));
figure, topoplot(A, EEG.chanlocs)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 1));
figure, topoplot(A, EEG.chanlocs)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 2));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 3));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 4));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 5));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 6));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 7));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 8));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 9));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 10));
R
r
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,11), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 11));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,12), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 12));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,13), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 13));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,14), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 14));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,15), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 15));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,16), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 16));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 17));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,17), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,18), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 18));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 19));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 20));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,19), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,20), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, :));
r
B(1,:)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 1));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 6));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 8));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 1));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 2));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 3));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 4));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 5));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 6));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 7));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, topoplot(A, EEG.chanlocs)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 8));
for i = 1:20, [A,B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
r
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 1));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, 2));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,7));
figure, topoplot(A, EEG.chanlocs)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,10));
figure, topoplot(A, EEG.chanlocs)
theta_eeg_hilbert = abs(hilbert(EEG.data'))';
theta_eeg_hilbert_hrf = []; for i = 1:EEG.nbchan, theta_eeg_hilbert_hrf(i,:) = decimate(double(conv(theta_eeg_hilbert(i,:), spm_hrf(1/EEG.srate))), EEG.srate*2.04, 'FIR'); end;
for i = 1:20, [A,B,r(i)] = cca(theta_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
r
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,7));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,10));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
delta_eeg_hilbert = abs(hilbert(EEG.data'))';
delta_eeg_hilbert_hrf = []; for i = 1:EEG.nbchan, delta_eeg_hilbert_hrf(i,:) = decimate(double(conv(delta_eeg_hilbert(i,:), spm_hrf(1/EEG.srate))), EEG.srate*2.04, 'FIR'); end;
for i = 1:20, [A,B,r(i)] = cca(delta_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
r
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot(A, EEG.chanlocs)
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,5));
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,6));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,7));
figure, topoplot(pinv(A), EEG.chanlocs)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
gamma_eeg_hilbert = abs(hilbert(EEG.data'))';
gamma_eeg_hilbert_hrf = []; for i = 1:EEG.nbchan, gamma_eeg_hilbert_hrf(i,:) = decimate(double(conv(gamma_eeg_hilbert(i,:), spm_hrf(1/EEG.srate))), EEG.srate*2.04, 'FIR'); end;
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,5));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
for i = 1:20, [A,B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
r
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(gamma_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot(pinv(A), EEG.chanlocs)
figure, topoplot((A), EEG.chanlocs)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot((A), EEG.chanlocs)
[A,B,r] = cca(theta_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot((A), EEG.chanlocs)
[A,B,r] = cca(delta_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot((A), EEG.chanlocs)
[A,B,r] = cca(gamma_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,6));
figure, topoplot((A), EEG.chanlocs)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,6));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(theta_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,6));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(gamma_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,6));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(delta_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,6));figure, topoplot((A), EEG.chanlocs);
msEEG = microstateEEG(EEG, 8);
EEG
alpha_eeg_hilbert_ds = []; for i = 1:EEG.nbchan, alpha_eeg_hilbert_ds(i,:) = decimate(double(alpha_eeg_hilbert(i,:)), EEG.srate*2.04, 'FIR'); end;
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,10:347)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,7:344)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,8:345)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,6:343)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,6:343)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,7:344)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,8:345)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,9:346)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,7:344)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,8:345)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,9:346)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,11:348)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,12:349)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,13:350)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,12:349)',bold.winv(10:347,5));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,12:349)',bold.winv(10:347,7));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,11:348)',bold.winv(10:347,7));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:349)',bold.winv(10:347,7));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,7));figure, topoplot((A), EEG.chanlocs);
%-- 5/13/13 10:57 AM --%
delete bias* binica* temp*
eeglab
load('matlab.mat')
%-- 5/13/13 11:01 AM --%
load('matlab.mat')
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,7:344)',bold.winv(10:347,7));figure, topoplot((A), EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,8:345)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,9:347)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,9:346)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,10:347)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,10:347)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,8:345)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,7:344)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,6:343)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,7:344)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,6:343)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,5:342)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,4:341)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,5:342)',bold.winv(10:347,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,11:348)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,12:349)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,10:347)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,10:347)',bold.winv(10:347,11));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,9:346)',bold.winv(10:347,11));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,8:345)',bold.winv(10:347,11));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,8:345)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_ds(:,10:347)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,11:348)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,9:346)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,8:345)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,7:344)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,6:343)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,5:342)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,11:348)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,12:349)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,13:350)',bold.winv(10:347,10));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,11:348)',bold.winv(10:347,10));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,11:348)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,12:349)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,13:350)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,14:351)',bold.winv(10:347,4));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,13:350)',bold.winv(10:347,4));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,13:350)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,12:347)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,12:349)',bold.winv(10:347,7));
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,11:348)',bold.winv(10:347,7));
figure, topoplot(A, EEG.chanlocs);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
msEEG
176971/510
test = conv(gfp, spm_hrf(1/250));
test = conv(msEEG.gfp, spm_hrf(1/250));
184971/510
plot(spm_hrf(1/250))
help decimate
for i = 1:20, [A,B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
r
for i = 1:20, [A,B,r(i)] = cca(gamma_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
f
r
for i = 1:20, [A,B,r(i)] = cca(theta_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
r
for i = 1:20, [A,B,r(i)] = cca(delta_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
r
figure, topoplot(A, EEG.chanlocs);
for i = 1:20, [A,B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30, i));end;
r
figure, topoplot(A)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,30:50)',bold.winv(30:50,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,60:80)',bold.winv(60:80,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30,4));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30,5));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30,6));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:40)',bold.winv(10:40,7));
f
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:50)',bold.winv(10:50,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:60)',bold.winv(10:60,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:20)',bold.winv(10:20,7));
figure, topoplot(A, EEG.chanlocs);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30,7));
figure, topoplot(A, EEG.chanlocs);
for i = 1:20, [A(:,i),B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,10:30)',bold.winv(10:30, i));end;
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(:,i), EEG.chanlocs); title(num2str(i)); end;
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,7));
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(:,i), EEG.chanlocs); title(num2str(i)); end;
for i = 1:20, [A(:,i),B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(:,i), EEG.chanlocs); title(num2str(i)); end;
for i = 1:20, [A(:,i),B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,15:35)',bold.winv(15:35, i));end;
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(:,i), EEG.chanlocs); title(num2str(i)); end;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
for i = 1:20, [A(:,i),B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,(10:30)+i*5)',bold.winv((10:30)+i*5, 4));end;
r
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(:,i), EEG.chanlocs); title(num2str(i)); end;
for i = 1:20, [A(:,i),B,r(i)] = cca(theta_eeg_hilbert_hrf(:,(10:30)+i*5)',bold.winv((10:30)+i*5, 4));end;
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(:,i), EEG.chanlocs); title(num2str(i)); end;
for i = 1:20, [A(:,i),B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,(10:30)+i*5)',bold.winv((10:30)+i*5, 10));end;
figure, for i = 1:20, subplot(4, 5, i), topoplot(A(:,i), EEG.chanlocs); title(num2str(i)); end;
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,[4 6 7 10]));
figure, topoplot(A(1,:), EEG.chanlocs);
figure, topoplot(A(:,1), EEG.chanlocs);
figure, topoplot(A(:,2), EEG.chanlocs);
figure, topoplot(A(:,3), EEG.chanlocs);
figure, topoplot(A(:,4), EEG.chanlocs);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,11), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,:));
r
find(r>0.9)
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',zscore(bold.winv(10:347,:)));
r
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,:));
r
B
for i = 1:20, [A,B,r(i)] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347, i));end;
r
find(r>0.8)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
[A,B,r] = cca(alpha_eeg_hilbert_hrf(:,10:347)',bold.winv(10:347,[2 4 5 6 7 8 9 10 11 12]));
r
figure, topoplot(A(:,1), EEG.chanlocs);
figure, topoplot(A(:,2), EEG.chanlocs);
figure, topoplot(pinv(A(:,1)), EEG.chanlocs);
A = pinv(A);
figure, topoplot(A(:,1), EEG.chanlocs);
figure, topoplot(A(1,:), EEG.chanlocs);
figure, topoplot(A(2,:), EEG.chanlocs);
figure, topoplot(A(3,:), EEG.chanlocs);
figure, topoplot(A(4,:), EEG.chanlocs);
B(:,4)
B(:,5)
B(:,6)
B(:,7)
B(:,8)
B(:,1)
B(:,2)
%-- 5/13/13 11:56 AM --%
eeglab
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:8, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, for i = 1:3, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, fftplot(msEEG.alpha, EEG.srate, [0.1 0.5])
%-- 5/13/13 12:05 PM --%
eeglab
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
msEEG.L
msEEG
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
imagesc(corr([msEEG.alpha_hrf(:,10:347); msEEG.L_hrf(:,10:347)]', bold.winv(10:347,:)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
imagesc(corr([msEEG.alpha_hrf(:,10:347); msEEG.L_hrf(:,10:347)]', bold.winv(10:347,:)))
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, topoplot(msEEG.Gamma(:,3), EEG.chanlocs)
print(gcf, '-dtiff','fig.tiff' )
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, topoplot(msEEG.Gamma(:,4), EEG.chanlocs)
print(gcf, '-dtiff','fig.tiff' )
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, topoplot(msEEG.Gamma(:,4), EEG.chanlocs)
print(gcf, '-dtiff','fig.tiff' )
figure, topoplot(msEEG.Gamma(:,4), EEG.chanlocs)
print(gcf, '-dtiff','fig.tiff' )
clear all
close all
eeglab
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
imagesc(corr([msEEG.alpha_hrf(:,10:347); msEEG.L_hrf(:,10:347)]', bold.winv(10:347,:)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,16), [], []);
imagesc(corr([msEEG.alpha_hrf(:,10:347); msEEG.L_hrf(:,10:347)]', bold.winv(10:347,:)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
imagesc(corr([msEEG.alpha_hrf(:,10:347); msEEG.L_hrf(:,10:347)]', bold.winv(10:347,:)))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
imagesc(corr([msEEG.alpha_hrf(:,10:347); msEEG.L_hrf(:,10:347)]', bold.winv(10:347,:)))
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
msEEG = microstateEEG(EEG, 2);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, topoplot(msEEG.Gamma(:,1), EEG.chanlocs)
print(gcf, '-dtiff','fig.tiff' )
EEG.history
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, topoplot(msEEG.Gamma(:,2), EEG.chanlocs)
print(gcf, '-dtiff','fig.tiff' )
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
msEEG = microstateEEG(EEG, 4);
figgure, for
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
msEEG = microstateEEG(EEG, 2);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( [msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, topoplot(msEEG.Gamma(:,1), EEG.chanlocs)
print(gcf, '-dtiff','fig.tiff' )
figure, topoplot(msEEG.Gamma(:,2), EEG.chanlocs)
print(gcf, '-dtiff','fig.tiff' )
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
print(gcf, '-dtiff','fig.tiff' )
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
%-- 5/14/13 11:08 AM --%
eeglab
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARC/ql041913_1/CovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARC/ql041913_1/CovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/ql041913_1_BrainMask_05_91x109x91', 20);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,11), [], []);
help spm_hrf
plot(hrfn([6 16 1 1 6 0]))
plot(hrfn([1 0.4 1 1 5 12]))
t = 1:16
plot(hrfn([1 0.4 1 1 5 12]))
hin = 0;
plot(hrfn([1 0.4 1 1 5 12]))
for i = 1:20, ic(i,:) = eeg_getica(EEG,i); end;
for i = 1:20, ic_hrf(i,:) = decimate(conv(abs(hilbert(ic(i,:))), spm_hrf(1/EEG.srate)), EEG.srate*TR, 'FIR'); end;
for i = 1:20, ic_hrf(i,:) = decimate(conv(abs(hilbert(ic(i,:))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
for i = 1:20, ic_hrf(i,:) = decimate(conv(double(abs(hilbert(ic(i,:)))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
figure, imagesc(ic_hrf(:,10:347)', bold.winv(10:347,:));
figure, imagesc(corr(ic_hrf(:,10:347)', bold.winv(10:347,:)));
plot(ic(1,:))
plot(ic(2,:))
figure, fftplot(ic(1,:), EEG.srate, ')
figure, fftplot(ic(1,:), EEG.srate, [0.1 50])
figure, fftplot(ic(1,:), EEG.srate, [0.01 5])
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
figure, imagesc(corr(ic_hrf(:,10:347)', bold.winv(10:347,:)));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, imagesc(corr(ic_hrf(:,10:347)', bold.winv(10:347,:)));
R = corr(ic_hrf(:,10:347)', bold.winv(10:347,:));
figure, imagesc(R)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
plot([ic_hrf(10,10:347)' bold.winv(10:347,1)])
plot([mapstd(ic_hrf(10,10:347))' bold.winv(10:347,1)])
readphys22
P02048.physio
readphys22
/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/Data/ql041913/raw/P99328.physio
2.04
readphys22
/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/Data/ql041913/raw/P99328.physio
[353 2.04]
cr
resptime
plot(resp)
plot(respr)
plot(respintvl)
18913/720.12
18913/t
readphys22
/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/Data/ql041913/raw/P99328.physio
[353 2.04]
18913/754.4
fftplot(resp, 25, [0.1 5])
36.4/25
36.4*25
eeglab
corr(decimate(eeg_getica(EEG,1), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,1), 10))', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,1)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
plot([decimate(double(eeg_getica(EEG,1)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25)])
corr(decimate(double(eeg_getica(EEG,1)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,2)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,3)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,4)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,5)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,6)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,7)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,8)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,9)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,10)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,1)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,2)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
corr(decimate(double(eeg_getica(EEG,3)), 10)', resp((time0+TR*3)*25:(time0+TR*350)*25))
figure, ffpplot(eeg_getica(EEG,3), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,3), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,1), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,2), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,3), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,4), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,5), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,6), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,7), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,8), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,9), EEG.srate, [0.1 5])
figure, fftplot(eeg_getica(EEG,10), EEG.srate, [0.1 5])
clear all
cloes all
close all
eeglab
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
for i = 1:30, ic(i,:) = eeg_getica(EEG,i); end;
for i = 1:30, ic_hrf(i,:) = decimate(conv(mapstd(double(abs(hilbert(ic(i,:))))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
R = corr(ic_hrf(:,10:347)', bold.winv(10:347,:));
imagesc(R)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,16), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,16), [], []);
R = corr(ic_hrf(:,11:348)', bold.winv(10:347,:));
imagesc(R)
imagesc(R, [-0.3 0.3])
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
R = corr(ic_hrf(:,9:346)', bold.winv(10:347,:));
figure, imagesc(R, [-0.3 0.3])
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
R = corr(ic_hrf(:,10:347)', bold.winv(10:347,:));
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, imagesc(R, [-0.3 0.3])
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,16), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,14), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,15), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
R = corr(ic_hrf(:,9:346)', bold.winv(10:347,:));
figure, imagesc(R, [-0.3 0.3])
delete bias* binica* temp*
%-- 5/14/13 2:35 PM --%
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
eeglab
eeg_hrf = []; for i = 1:EEG.nbchan, eeg_hrf(i,:) = decimate(conv(mapstd(abs(hilbert(double(EEG.data(i,:))))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
plot(eeg_hrf(1:2,:))
plot(eeg_hrf(1:2,:)')
plot(eeg_hrf(1:3,:)')
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,3));
figure, topoplot(A)
figure, topoplot(A, EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,1));
figure, topoplot(A, EEG.chanlocs)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,13), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,14), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,15), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,16), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,17), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,18), [], []);
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,[1:4 6:11 13:16]));
r
B(:,1)
figure, topoplot(A, EEG.chanlocs)
figure, topoplot(A(:,1), EEG.chanlocs)
A = pinv(A)
figure, topoplot(A(1,:), EEG.chanlocs)
figure, topoplot(A(2,:), EEG.chanlocs)
figure, topoplot(A(3,:), EEG.chanlocs)
figure, topoplot(A(4,:), EEG.chanlocs)
figure, topoplot(A(1,:), EEG.chanlocs)
B = pinv(B);
B(1,:)
B(1,2)
B(2,:)
B(3,:)
B(4,:)
B(5,:)
B(6,:)
B(7,:)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,1));
figure, topoplot(A, EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,2));
figure, topoplot(A, EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,3));
figure, topoplot(A, EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,3));
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot(A, EEG.chanlocs)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot(A, EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,5));
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,6));
figure, topoplot(A, EEG.chanlocs)
plot(eeg_hrf(1:10,:))
plot(eeg_hrf(1:10,:)')
plot(eeg_hrf(1:100,:)')
eeg_hrf = []; for i = 1:EEG.nbchan, eeg_hrf(i,:) = decimate(conv(mapstd(abs(hilbert(double(EEG.data(i,:))))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
plot(eeg_hrf(1:100,:)')
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,1));
figure, topoplot(A, EEG.chanlocs)
figure, topoplot(pinv(A(, EEG.chanlocs)
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,2));
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,3));
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,4));
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,5));
figure, topoplot(pinv(A), EEG.chanlocs)
[A,B,r] = cca(eeg_hrf(:,10:347)',bold.winv(10:347,5));
A = pinv(A)
eeg_ds = []; for i = 1:EEG.nbchan, eeg_ds(i,:) = decimate(mapstd(abs(hilbert(double(EEG.data(i,:))))), EEG.srate*2.04, 'FIR'); end;
plot(eeg_ds(1:100, :)')
plot(abs(hilbert(double(EEG.data(20,:)))))
figure, plot(eeg_ds(20,:))
plot(abs(hilbert(double(EEG.data(20,:)))))
plot(decimate(abs(hilbert(double(EEG.data(20,:)))), EEG.srate*2.04))
figure, plot(abs(hilbert(double(EEG.data(20,:)))))
plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 100))
figure, plot(abs(hilbert(double(EEG.data(20,:)))))
plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 200))
plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 300))
figure, plot(abs(hilbert(double(EEG.data(20,:)))))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 400))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 500))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 510))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 500))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 510))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 500))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 500)), xlim([1 300]))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 500)), xlim([1 300])
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 510)), xlim([1 300])
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 1)), xlim([1 300])
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 2)), xlim([1 300])
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 3)), xlim([1 300])
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 3)))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 3))
figure, plot(decimate(abs(hilbert(double(EEG.data(20,:)))), 1))
figure, plot(eeg_getica(EEG,1))
figure, plot(EEG.data(20,:))
figure, plot(eeg_getica(EEG,1))
figure, plot(abs(hilbert(eeg_getica(EEG,1))))
figure, plot(abs(hilbert(abs(hilbert(eeg_getica(EEG,1))))))
figure, plot([eeg_getica(EEG,1); abs(hilbert(eeg_getica(EEG,1))); abs(hilbert(abs(hilbert(eeg_getica(EEG,1)))))])
figure, plot([eeg_getica(EEG,1); abs(hilbert(eeg_getica(EEG,1))); abs(hilbert(abs(hilbert(eeg_getica(EEG,1)))))]')
plot(bold.winv(:,1))
figure, plot(bold.winv(:,1))
figure, plot(bold.winv(:,2))
figure, plot(bold.winv(:,3))
figure, plot(bold.winv(:,4))
figure, plot(bold.winv(:,3))
comp_hrf = []; for i = 1:7, comp_hrf(i,:) = decimate(conv(abs(hilbert(eeg_getica(EEG,i))), spm_hrf(1/EEG.srate)), EEG.srate*2.04); end;
comp_hrf = []; for i = 1:7, comp_hrf(i,:) = decimate(conv(double(abs(hilbert(eeg_getica(EEG,i)))), spm_hrf(1/EEG.srate)), EEG.srate*2.04); end;
figure, imagesc(corr(comp_hrf'))
glm = myglm( [comp_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
comp_hrf = []; for i = 1:5, comp_hrf(i,:) = decimate(conv(double(abs(hilbert(eeg_getica(EEG,i)))), spm_hrf(1/EEG.srate)), EEG.srate*2.04); end;
glm = myglm( [comp_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
%-- 5/15/13 11:14 AM --%
eeglab
%-- 5/15/13 11:17 AM --%
eeglab
for i = 1:EEG.nbchan, EEG.data(i,:) = abs(hilbert(EEG.data(i,:))); end;
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
msEEG = microstateEEG(EEG, 8);
figure, for i = 1:8, subplottight(1,8,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
ic_hrf = []; for i = 1:20, ic_hrf(i,:) = decimate(conv(mapstd(abs(hilbert(double(eeg_getica(EEG,i))))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
R = corr(ic_hrf(:,10:347)', bold.winv(10:347,:));
figure, imagesc(R)
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,16), [], []);
glm = myglm( [ic_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,13), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,14), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,15), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,16), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,17), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,18), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,19), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,20), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [-3 3], []);
glm = myglm( [ic_hrf(7,:)]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [-3 3], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-4 4], []);
glm = myglm( [msEEG.gfp_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-4 4], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-6 6], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-6 6], [-20 20]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-6 6], [-15 15]);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-6 6], [-10 10]);
eeg_hrf = []; for i = 1:EEG.nbchan, eeg_hrf(i,:) = decimate(conv(mapstd(abs(hilbert(double(EEG.data(i,:))))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
ic_hrf = []; for i = 1:20, ic_hrf(i,:) = decimate(conv(mapstd(double(eeg_getica(EEG,i))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
glm = myglm( [ic_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,9), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,11), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,12), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,13), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,14), [], []);
plot(ic_hrf')
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,15), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,16), [], []);
memory
whos
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,16), [], []);
ic_hrf = []; for i = 1:20, ic_hrf(i,:) = decimate(conv(mapstd(abs(hilbert(double(eeg_getica(EEG,i))))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
plot(ic_hrf')
glm = myglm( [ic_hrf]', bold.func, bold.mask, [], [10 347], [] );
bold
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
%-- 5/15/13 12:44 PM --%
eeglab
eeg_hilbert = []; for i = 1:EEG.nbchan, eeg_hilbert(i,:) = abs(hilbert(EEG.data(i,:))); end;
plot([EEG.data(1,:); eeg_hilbert(1,:)])
plot([EEG.data(1,:); eeg_hilbert(1,:)]')
msEEG = microstateEEG(EEG, 8);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
glm = myglm( [msEEG.gfp_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats =
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-6 6], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
%-- 5/15/13 12:55 PM --%
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/xh032013swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/xh032013/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
load('reg_ulf.mat')
glm = myglm( reg(4:end, 4), bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-1 1], []);
eeglab
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( msEEG.alpha_hrf', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
glm1 = glm;
glm = myglm( reg(4:end, 4), bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-1 1], []);
corr(msEEG.alpha(4,1:350)', reg(4:353))
corr(msEEG.alpha(2,1:350)', reg(4:353,4))
corr(msEEG.alpha_hrf(2,1:350)', reg(4:353,4))
R = corr(msEEG.alpha_hrf(:,1:350)', reg(4:353,:));
figure, imagesc(R)
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, imagesc(R)
figure, imagesc(R, [-1 1])
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
plot(spm_hrf(1/EEG.srate))
plot(spm_hrf(2.04))
plot(spm_hrf(1))
plot([0:1/EEG.srate:32-1/EEG.srate],spm_hrf(1/EEG.srate))
plot([0:1/EEG.srate:(32-1/EEG.srate)],spm_hrf(1/EEG.srate))
size(spm_hrf(1/EEG.srate))
size([0:1/EEG.srate:(32-1/EEG.srate)])
plot([0:1/EEG.srate:32],spm_hrf(1/EEG.srate))
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,2), [], []);
load('e226.mat')
corr(data', msEEG.alpha(2,:)')
corr(data(3*510:end)', msEEG.alpha(2,:)')
corr(data((3*510+1):end)', msEEG.alpha(2,:)')
size(msEEG.alpha)
corr(data((3*510+1):(end-3*510))', msEEG.alpha(2,:)')
size(data((3*510+1):(end-3*510))
size(data((3*510+1):(end-3*510)
size(data((3*510+1):(end-3*510)))
size(data((3*510+1):(end-2*510)))
size(data((3*510):(end-2*510)))
corr(data((3*510):(end-2*510))', msEEG.alpha(2,:)')
corr(data((3*510+1):(end-2*510+1))', msEEG.alpha(2,:)')
corr(msEEG.alpha_hrf(2,1:347)', reg(4:350,4))
plot(EEG.L==2)
plot(msEEG.L==2)
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 4, 200, EEG.chanlocs, 10, 1, 25, 1);
figure, for i = 1:4, subplottight(1,4,i), topoplot(Gamma(:,i), EEG.chanlocs); end;
corr(alpha(1,:)', msEEG.alpha(2,:)')
figure, for i = 1:4, subplottight(1,4,i), topoplot(Gamma(:,i), EEG.chanlocs); end;
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 4, 200, EEG.chanlocs, 10, 1, 25, 1);
corr(alpha(1,:)', msEEG.alpha(2,:)')
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,4), [], []);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
for i = 1:EEG.pnts, alpha_2(i) = EEG.data(:,i)'*msEEG.Gamma(:,2); end;
plot(alpha_2)
corr(data((3*510):(end-2*510))', alpha_2')
corr(data((3*510+1):(end-2*510+1))', alpha_2')
corr(data((3*510+2):(end-2*510+2))', alpha_2')
corr(data((3*510-1):(end-2*510-1))', alpha_2')
for i = 1:EEG.nbchan, chanR(i) = EEG.chanlocs(i).radius; end;
find(chanR>0.5)'
find(chanR<0.5)'
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, topoplot(msEEG.Gamma,EEG.chanlocs)
figure, topoplot(msEEG.Gamma(:,4),EEG.chanlocs)
help topoplot
figure, topoplot(msEEG.Gamma(:,4),EEG.chanlocs, 'maplimits', [-1 1])
figure, topoplot(msEEG.Gamma(:,4),EEG.chanlocs, 'maplimits', [-0.5 0.5])
figure, topoplot(msEEG.Gamma(:,4),EEG.chanlocs)
figure, topoplot(msEEG.Gamma(:,4),EEG.chanlocs, 'maplimits', [-0.1 0.1])
load('e226 (1).mat')
corr(e226((3*510):(end-2*510))', msEEG.alpha')
corr(e226((3*510):(end-2*510))', msEEG.alpha(2,:)')
corr(data', e226')
figure, topoplot(msEEG.Gamma(:,1),EEG.chanlocs, 'maplimits', [-0.1 0.1])
figure, topoplot(msEEG.Gamma(:,1),EEG.chanlocs, 'maplimits', [-1 1])
figure, topoplot(msEEG.Gamma(:,2),EEG.chanlocs, 'maplimits', [-1 1])
figure, topoplot(msEEG.Gamma(:,3),EEG.chanlocs, 'maplimits', [-1 1])
figure, topoplot(msEEG.Gamma(:,4),EEG.chanlocs, 'maplimits', [-1 1])
figure, topoplot(msEEG.Gamma(:,4),EEG.chanlocs, 'maplimits', [-0.3 0.3])
figure, topoplot(msEEG.Gamma(:,1),EEG.chanlocs, 'maplimits', [-0.3 0.3])
figure, topoplot(msEEG.Gamma(:,2),EEG.chanlocs, 'maplimits', [-0.3 0.3])
figure, topoplot(msEEG.Gamma(:,3),EEG.chanlocs, 'maplimits', [-0.3 0.3])
figure, topoplot(msEEG.Gamma(:,4),EEG.chanlocs, 'maplimits', [-0.3 0.3])
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,4), [], []);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,2), [], []);
glm = myglm( msEEG.gfp_hrf, bold.func, bold.mask, [], [10 347], [] );
glm = myglm( msEEG.gfp_hrf', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
msEEG1 = msEEG;
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( [msEEG.gfp_hrf; msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,4), [-4 4], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
msEEG = microstateEEG(EEG, 4);
figure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
glm = myglm( [msEEG.gfp_hrf; msEEG.alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm1.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
[L, Gamma, alpha, R, sigma_mcv, log] = mscluster(EEG.data, 4, 200, EEG.chanlocs, 10, 1, 25, 1);
figure, for i = 1:4, subplottight(1,4,i), topoplot(Gamma(:,i), EEG.chanlocs); end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = decimate(conv(abs(alpha(i,:)), spm_hrf(1/EEG.srate)), EEG.srate*TR, 'FIR')
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = decimate(conv(abs(alpha(i,:)), spm_hrf(1/EEG.srate)), EEG.srate*TR, 'FIR'); end;
alpha_hrf = []; for i = 1:size(alpha,1), alpha_hrf(i,:) = decimate(conv(abs(alpha(i,:)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
glm = myglm( [alpha_hrf]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
figure, for i = 1:4, subplottight(1,4,i), topoplot(Gamma(:,i), EEG.chanlocs); end;
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-1 1], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-2 2], []);
delete bias* binica* temp*
%-- 5/15/13 9:21 PM --%
java.opts
java.lang.Runtime.getRuntime.maxMemory
ans/1024
/1024
ans/1024
java.lang.Runtime.getRuntime.freeMemory
java.lang.Runtime.getRuntime.maxMemory
java.lang.Runtime.getRuntime.totalMemory
java.lang.Runtime.getRuntime.freeMemory
%-- 5/15/13 9:24 PM --%
java.lang.Runtime.getRuntime.maxMemory
java.lang.Runtime.getRuntime.freeMemory
java.lang.Runtime.getRuntime.totalMemory
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
java.lang.Runtime.getRuntime.totalMemory
java.lang.Runtime.getRuntime.freeMemory
java.lang.Runtime.getRuntime.maxMemory
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
java.lang.Runtime.getRuntime.maxMemory
java.lang.Runtime.getRuntime.freeMemory
java.lang.Runtime.getRuntime.totalMemory
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
java.lang.Runtime.getRuntime.totalMemory
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
java.lang.Runtime.getRuntime.totalMemory
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
java.lang.Runtime.getRuntime.totalMemory
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
java.lang.Runtime.getRuntime.totalMemory
java.lang.Runtime.getRuntime.maxMemory
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
java.lang.Runtime.getRuntime.totalMemory
java.lang.Runtime.getRuntime.freeMemory
java.lang.Runtime.getRuntime.totalMemory
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
matlabroot
computer('arch')
version -java
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 10);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,1), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,2), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,3), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,4), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,5), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,6), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,10), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,7), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,8), [], []);
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
%-- 5/16/13 11:57 AM --%
top
java.lang.Runtime.getRuntime.totalMemory
eeglab
java.lang.Runtime.getRuntime.totalMemory
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
for i=1:inf
java.lang.Runtime.getRuntime.gc
fprintf('%3.0f: %1.0f Byte free\n',i,java.lang.Runtime.getRuntime.freeMemory);
figure;
end
close all
clear all
Runtime.gc
java.lang.Runtime.getRuntime.gc
%-- 5/17/13 2:11 PM --%
figure,
figure
help sprint
help sprintf
figure
mfigure
figure
%-- 5/18/13 11:41 AM --%
eeglab
%-- 5/18/13 11:43 AM --%
eeglab
date
%-- 5/19/13 10:02 PM --%
eglab
eeglab
%-- 5/19/13 10:04 PM --%
eeglab
myfigure, plot(eeg_getica(EEG,7))
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(zscore(bcgTemp),1);
myfigure, plot(EEG.times, bcgTemp); hold on; plot(EEG.times(peakLoc), bcgTemp(peakLoc))
myfigure, plot(EEG.times, bcgTemp); hold on; plot(EEG.times(peakLoc), bcgTemp(peakLoc), 'ro')
peakLoc = peakfinder(zscore(bcgTemp),4);
myfigure, plot(EEG.times, bcgTemp); hold on; plot(EEG.times(peakLoc), bcgTemp(peakLoc), 'ro')
help interp
myfigure, plot(EEG.times, bcgTemp); hold on; plot(EEG.times(peakLoc), bcgTemp(peakLoc), 'ro')
bcgPeak = interp(bcgTemp, 176971/900);
bcgPeak = interp(double(bcgTemp), 176971/900);
help interp
bcgPeak = interp(double(bcgTemp), 200);
clear bcgPeak
bcgPeak = interp(double(bcgTemp), 20);
bcgPeak = interp(double(peakLoc), 200);
bcgPeak = interp(double(bcgTemp(peakLoc)), 200);
plot([bcgPeak(1:176971); bcgTemp])
plot([bcgPeak(1:176971); bcgTemp]')
bcgLow = eeg_getica(EEG,7);
myfigure, plot([bcgLow; bcgTemp]')
myfigure, plot([bcgLow+20; bcgTemp]')
bcgLow = eeg_getica(EEG,1);
myfigure, plot([bcgLow+20; bcgTemp]')
bcgLow = eeg_getica(EEG,1);
myfigure, plot([bcgLow+20; bcgTemp]')
help fit
FO = fit(EEG.times(peakLoc), bcgTemp(peakLoc), 'poly1');
FO = fit(EEG.times(peakLoc)', bcgTemp(peakLoc)', 'poly1');
FO
FO = fit(EEG.times(peakLoc)', bcgTemp(peakLoc)', 'linearinterp');
FO
FO.x
FO.p
help fit
bcgPeak = abs(hilbert(bcgTemp));
myfigure, plot([bcgTemp; bcgPeak]')
[curve, goodness] = fit( EEG.times(peakLoc)', bcgTemp(peakLoc)', 'pchipinterp' );
curv
curve
plot(curve)
delete bias* binica* temp*
help interp1
bcgLow = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
myfigure, plot([bcgTemp; bcgLow]')
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgLow = eeg_getica(EEG,1);
corr(bcgLow', bcgPeak')
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak_hrf(EEG,i)))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR'); end;
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak_hrf(EEG,i)))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak(EEG,i)))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
bcgLow_hrf = decimate(conv(mapstd(abs(double(bcgLow))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
glm = myglm( [bcgPeak_hrf; bcgLow_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [-3 3], []);
myfigure, fftplot(bcgPeak, EEG.srate, [0.1 5]);
bcgTemp = eeg_getica(EEG,2);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-4 4], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
glm = myglm( [bcgLow_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, plot([bcgLow_hrf; bcgPeak_hrf])
myfigure, plot([bcgLow_hrf; bcgPeak_hrf]')
myfigure, plot([bcgPeak_hrf]')
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
bcgTemp = eeg_getica(EEG,1);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
bcgTemp = eeg_getica(EEG,1);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-1 1], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,2), [-1 1], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,3), [-1 1], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-1 1], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-2 2], []);
myfigure, fftplot(bcgPeak, EEG.srate, [0.1 5]);
bcgTemp = -eeg_getica(EEG,1);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-2 2], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-1 1], []);
myfigure, fftplot(bcgPeak, EEG.srate, [0.1 5]);
bcgTemp = eeg_getica(EEG,4);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
myfigure, plot([bcgTemp; bcgPeak]')
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/xh032013/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 5);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-1 1], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, fftplot(bcgPeak, EEG.srate, [0.1 5]);
myfigure, plot([bcgTemp; bcgPeak]')
bcgTemp = eeg_getica(EEG,8);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
myfigure, plot([bcgTemp; bcgPeak]')
myfigure, fftplot(bcgPeak, EEG.srate, [0.1 5]);
myfigure, fftplot(bcgPeak(100:18000), EEG.srate, [0.1 5]);
myfigure, fftplot(bcgPeak(100:150000), EEG.srate, [0.1 5]);
plot(bcgPeak_hrf)
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
glm = myglm( [bcgPeak_hrf(4:end)]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, fftplot(bcgPeak(100:150000), EEG.srate, [0.1 5]);
bcgTemp = eeg_getica(EEG,8);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgTemp = eeg_getica(EEG,7);
bcgTemp = eeg_getica(EEG,5);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
myfigure, fftplot(bcgPeak(100:150000), EEG.srate, [0.1 5]);
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
myfigure, fftplot(bcgPeak(100:150000), EEG.srate, [0.1 5]);
bcgTemp = eeg_getica(EEG,5);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak1 = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
corr(bcgPeak', bcgPeak1')
figure, plot([bcgPeak; bcgPeak1])
figure, plot([bcgPeak; bcgPeak1]')
bcgPeak_hrf1 = decimate(conv(mapstd(abs(double(bcgPeak1))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
corr(bcgPeak_hrf', bcgPeak_hrf1')
glm = myglm( [bcgPeak_hrf1]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf1 = decimate(conv(mapstd(abs(double(bcgPeak1))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
temp = eeg_getica(EEG,3);
myfigure, fftplot(temp, EEG.srate, [0.1 5]);
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-4 4], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-8 8], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-7 7], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
bcgTemp = eeg_getica(EEG,2);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-5 5], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-4 4], []);
%-- 5/20/13 10:16 AM --%
readphys22
/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/Data/ql041913/raw/P99328.physio
[353 2.04]
cr
clear all
load('cr')
plot(cr)
clear all
eeglab
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(abs(double(bcgPeak))), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
load('cr')
corr(bcgPeak_hrf(1:347)', cr(4:350,:))
myfigure, plot([bcgPeak_hrf(1:347)', cr(4:350,:)])
myfigure, plot(zscore([bcgPeak_hrf(1:347)', cr(4:350,:)]))
myfigure, plot(zscore([bcgPeak_hrf(1:347)', cr(4:350,3)]))
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_2/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
corr(bcgPeak_hrf(1:347)', cr(4:350,:))
myfigure, plot([bcgTemp; bcgPeak]')
myfigure, plot(EEG.times, [bcgTemp; bcgPeak]')
myfigure, plot(EEG.times, [bcgTemp; bcgPeak]'), xlim(1000,5000)
myfigure, plot(EEG.times, [bcgTemp; bcgPeak]'), xlim([1000 5000])
myfigure, plot(EEG.times, [bcgTemp; bcgPeak]'), xlim([1000 10000])
myfigure, plot(EEG.times, [bcgTemp; bcgPeak]'), xlim([1000 100000])
myfigure, plot(EEG.times, [bcgTemp; bcgPeak]'), xlim([1000 50000])
grid on
help print
print(gcf, '-deps','fig.eps' )
print(gcf, '-depsc','fig.eps' )
bcgPeak_ds = decimate(mapstd(abs(double(bcgPeak)))), EEG.srate*2.04, 'FIR');
bcgPeak_ds = decimate(mapstd(abs(double(bcgPeak))), EEG.srate*2.04, 'FIR');
corr(bcgPeak_ds(1:347)', cr(4:350,:))
corr(bcgPeak_ds(2:348)', cr(4:350,:))
corr(bcgPeak_ds(1:348)', cr(4:350,:))
figure, plot(bcgPeak_ds)
corr(bcgPeak_ds(1:348)', cr(4:350,:))
corr(bcgPeak_ds(1:347)', cr(4:350,:))
glm = myglm( [bcgPeak_ds]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
glm = myglm( [zeros(1,3) bcgPeak_ds]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-4 4], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3.5 3.5], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
print(gcf, '-dtiff','fig.tiff' )
myfigure, plot([bcgPeak_ds(1:347); bcgPeak_hrf(1:347)]')
myfigure, plot(zscore([bcgPeak_ds(1:347); bcgPeak_hrf(1:347)]'))
glm = myglm( [bcgPeak_hrf(4:end)]', bold.func, bold.mask, [], [10 347], [] );
figure, disp_act_slc([5,8], anats(:,:,33:3:150), bold.act(:,:,11:50,9), [], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
bcgPeak_hrf = decimate(conv(mapstd(double(bcgPeak)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
plot(bcgPeak)
plot(mapstd(bcgPeak))
myfigure, subplot(2,1,1), plot([mapstd(bcgPeak(1:end-1))]), subplot(2,1,2), plot(bcgPeak_hrf)
myfigure, subplot(2,1,1), plot([mapstd(bcgPeak(1:end-3))]), subplot(2,1,2), plot(bcgPeak_hrf)
myfigure, subplot(2,1,1), plot([mapstd(bcgPeak(1:end-10))]), subplot(2,1,2), plot(bcgPeak_hrf)
myfigure, subplot(2,1,1), plot([mapstd(bcgPeak(1:end-50))]), subplot(2,1,2), plot(bcgPeak_hrf)
myfigure, subplot(2,1,1), plot([mapstd(bcgPeak)]), subplot(2,1,2), plot(bcgPeak_hrf)
myfigure, subplot(2,1,1), plot([mapstd(bcgPeak)]), subplot(2,1,2), plot(bcgPeak_hrf(1:347))
myfigure, subplot(2,1,1), plot([mapstd(bcgPeak)]), ylim([-3 3]), subplot(2,1,2), plot(bcgPeak_hrf(1:347))
myfigure, subplot(2,1,1), plot([mapstd(bcgPeak)]), ylim([-4 4]), subplot(2,1,2), plot(bcgPeak_hrf(1:347))
grid on
print(gcf, '-depsc','fig.eps' )
%-- 5/20/13 11:36 AM --%
eeglab
%-- 5/20/13 11:43 AM --%
eeglab
delete bias* binica* temp*
bcgTemp = eeg_getica(EEG,7);
bcgTemp = -eeg_getica(EEG,7);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(double(bcgPeak)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/ql041913_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
anat = load_nii('/Users/hxs/Documents/MATLAB/REST_V1.8_130303/Template/ch2bet.nii');
anats = imresize(anat.img, 1/2);
clear anat
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);f
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-4 4], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
print(gcf, '-depsc','fig.eps' )
print(gcf, '-dtiff','fig.tiff' )
bcgTemp = eeg_getica(EEG,4);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak1 = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
corr(bcgPeak1', bcgPeak)
corr(bcgPeak1', bcgPeak')
plot([bcgPeak1' bcgPeak'])
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
corr(bcgPeak1', bcgPeak')
bcgPeak_hrf = decimate(conv(mapstd(double(bcgPeak)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [-3 3], []);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
bcgTemp = eeg_getica(EEG,7);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(double(bcgPeak)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
bold = bold_ica('/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/FunImgARCWS/dq041813_1/swCovRegressed_4DVolume.nii', '/Users/hxs/Documents/Study/Research/EEG-fMRI_Resting/REST/Masks/AllResampled_GreyMask_02_91x109x91.nii', 20);
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
bcgTemp = -eeg_getica(EEG,1);
peakLoc = peakfinder(zscore(bcgTemp),4);
bcgPeak = interp1(EEG.times(peakLoc), bcgTemp(peakLoc), EEG.times, 'spline');
bcgPeak_hrf = decimate(conv(mapstd(double(bcgPeak)), spm_hrf(1/EEG.srate)), EEG.srate*2.04, 'FIR');
glm = myglm( [bcgPeak_hrf]', bold.func, bold.mask, [], [10 347], [] );
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
myfigure, fftplot(temp, EEG.srate, [0.1 5]);
myfigure, fftplot(bcgPeak, EEG.srate, [0.1 5]);
myfigure, disp_act_slc([5,8], anats(:,:,33:3:150), glm.t(:,:,11:50,1), [], []);
print(gcf, '-dtiff','fig.tiff' )
%-- 5/20/13 2:18 PM --%
eeglab
for i = 1:EEG.nbchan, chanR(i) = EEG.chanlocs(i).radius; end;
find(chanR<0.5)'
delete bias* binica* temp*
bcgTemp = eeg_getica(EEG,1);
peakLoc = peakfinder(zscore(bcgTemp),4);
%-- 5/21/13 1:34 PM --%
eeglab
msEEG = microstateEEG(EEG, 4);
myfigure, for i = 1:4, subplottight(1,4,i), topoplot(Gamma(:,i), EEG.chanlocs); end;
myfigure, for i = 1:4, subplottight(1,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
msEEG = microstateEEG(EEG, 12);
myfigure, for i = 1:12, subplottight(3,4,i), topoplot(msEEG.Gamma(:,i), EEG.chanlocs); end;
msEEG
matlab.prf
prfdir
prefdir
cd prefdir
cd ans
prefdir
cd ans
dir ans
%-- 5/21/13 2:02 PM --%
%-- 5/21/13 2:04 PM --%
